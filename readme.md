This program is beased on following snippet.
https://gist.github.com/eslachance/fb70fc036183b7974d3b9191601846ba